package org.opental.pdf.junit5.commands;

import static org.assertj.core.api.Assertions.assertThat;

import org.junit.jupiter.api.Test;
import org.opental.core.model.Response;
import org.opental.pdf.PdfDriver;
import org.opental.pdf.commands.Open;

class OpenTest {

	@Test
	void openProperPdfFile() {
		// create command to test
		Open cmd = new Open("open", "./src/test/resources/LoremIpsum_3Pages.pdf", "");
		Response result = cmd.executeImpl(new PdfDriver());

		// create a green result object
		Response resultCheck = new Response.Builder()
		    .setCode(Response.PASSED)
		    .setMessage("SUT file successfully read.")
		    .build();

		// check
		assertThat(resultCheck).usingRecursiveComparison().isEqualTo(result);
	}

	@Test
	void openEmptyPdfFile() {
		// create command to test
		Open cmd = new Open("open", "./src/test/resources/EmptyFile.pdf", "");
		Response result = cmd.executeImpl(new PdfDriver());

		// create a green result object
		Response resultCheck = new Response.Builder()
		    .setCode(Response.PASSED)
		    .setMessage("SUT file successfully read.")
		    .build();

		// check
		assertThat(resultCheck).usingRecursiveComparison().isEqualTo(result);
	}

	@Test
	void openNonExistingFile() {
		// create command to test
		Open cmd = new Open("open", "./src/test/resources/NonExistingFile.pdf", "");
		Response result = cmd.executeImpl(new PdfDriver());

		// check
		assertThat(result.getCode()).isEqualTo(Response.FAILED);
	}

	@Test
	void openInvalidPdfFile() {
		// create command to test
		Open cmd = new Open("open", "./src/test/resources/InvalidFile.pdf", "");
		Response result = cmd.executeImpl(new PdfDriver());

		// check
		assertThat(result.getCode()).isEqualTo(Response.FAILED);
	}
	
	@Test
	void openPasswordProtectedPdfFile() {
		// create command to test
		Open cmd = new Open("open", "./src/test/resources/ProtectedWithPassword.pdf", "");
		Response result = cmd.executeImpl(new PdfDriver());

		// check
		assertThat(result.getCode()).isEqualTo(Response.FAILED);
    }
}